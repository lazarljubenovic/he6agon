!function(){"use strict";class t{constructor(){this.map=new Map}set(t,s,n){this.map.has(t)||this.map.set(t,new Map),this.map.get(t).set(s,n)}get(t,s){const n=this.map.get(t);if(void 0!==n)return n.get(s)}t(t,s){const n=this.get(t,s);if(void 0===n)throw new Error(`Nothing at (${t}, ${s}).`);return n}has(t,s){const n=this.map.get(t);return void 0!==n&&n.has(s)}delete(t,s){if(!this.map.has(t))return;const n=this.map.get(t),i=n.get(s);return n.delete(s),i}keys(){const t=[];for(const s of this.map.keys()){const n=this.map.get(s);for(const i of n.keys())t.push([s,i])}return t}values(){return this.keys().map(([t,s])=>this.map.get(t).get(s))}toString(){return this.keys().map(([t,s])=>{return`${t} : ${s} => ${this.get(t,s)}`}).join("\n")}}function s(t,s,o){const r=document.createElementNS("http://www.w3.org/2000/svg",t);return null!=s&&n(r,s),null!=o&&i(r,...o),r}function n(t,s){for(const[n,i]of s)t.setAttribute(n,i)}function i(t,...s){t.append(...s)}function o(t,...s){t.classList.add(...s)}function r(t,s){for(const[n,i]of s)t.dataset[n]=i}function e(t){return t[Math.floor(Math.random()*t.length)]}const h=t=>new Promise(s=>setTimeout(s,t));function c(t,s,n){const i=t.get(s);null==i?t.set(s,new Set([n])):i.add(n)}function a(t,s,n=2){const i=[];let o=0,r=0;for(let e=1;e<t.length;e++){s(t[e-1],t[e])?r=e:(r-o+1>=n&&i.push([o,r]),o=e)}return r-o+1>=n&&i.push([o,r]),i}function u(t,s){return[t[0]+s[0],t[1]+s[1]]}function l(t,s){return t[0]==s[0]&&t[1]==s[1]}function f(t,s){return t.some(t=>l(t,s))}const w=[[1,-1],[1,0],[0,1],[-1,1],[-1,0],[0,-1]];function d(t){return function(s){return function(t,s){const[n,i]=t,o=-(n+i),[r,e]=s,h=-(r+e),c=Math.abs(n-r),a=Math.abs(i-e),u=Math.abs(o-h);return Math.max(c,a,u)}([0,0],s)<=t}}function y(t){return function(s){return function(t){return w.map(s=>u(t,s))}(s).filter(d(t))}}function g(t,s,n,i){const o=[[t]],r=[t];for(;o.length>0;){const t=o.shift(),e=t[t.length-1];if(l(e,s))return t;const h=y(i)(e).filter(t=>!f(r,t)).filter(n);for(const s of h)o.push([...t,s]),r.push(s)}return null}function m(t,s,n=!1){const i=[Math.sign(s[0]-t[0]),Math.sign(s[1]-t[1])],o=[t];for(;!l(o[o.length-1],s);)o.push(u(o[o.length-1],i));return!n&&o.length>1&&o.pop(),o}function p(t,s){const n=t+function(t){const[s,n]=t,i=-(s+n),o=Math.abs(s),r=Math.abs(n),e=Math.abs(i);return Math.max(o,r,e)}(s)+1;return Array.from({length:n}).map((t,n)=>(function(t){if(0==t)return[[0,0]];const s=w.map(s=>(function(t,s){return[t*s[0],t*s[1]]})(t,s)),n=[];for(let t=1;t<s.length;t++){const i=s[t-1],o=s[t];n.push(...m(i,o))}const i=s[0],o=s[s.length-1];return n.push(...m(o,i)),n})(n).map(t=>u(s,t)))}function M(t){return p(t,[0,0]).reduce((t,s)=>[...t,...s])}const $=[function(t){return t[0]},function(t){return t[1]},function(t){return-t[0]-t[1]}];function v(t,s){const n=Math.min(t.length,s.length);for(let i=0;i<n;i++){const n=t[i],o=s[i];if(Array.isArray(n)&&Array.isArray(o)){const t=v(n,o);if(0!=t)return t}else{if(n<o)return-1;if(n>o)return 1}}return t.length<s.length?-1:t.length>s.length?1:0}function k(t){return $.map(s=>(function(t,s){const n=new Map;for(const i of t)c(n,s(i),i);return n})(t,s)).map(t=>[...t.values()].map(t=>[...t].sort(v)).sort(v)).sort(v)}var A=Object.freeze({s:t=>t,i:t=>t*t,o:t=>t*(2-t),h:t=>t<.5?2*t*t:(4-2*t)*t-1});const T=()=>{};class E{constructor(t,s){this.duration=t,this.u=s,this.l=T,this.g=T,this.m=T}p(t){return this.l=t,this}M(t){return this.g=t,this}$(t){return this.m=t,this}v(){this.l();const t=Date.now(),s=t+this.duration,n=()=>{const i=Date.now(),o=(i-t)/this.duration;i>s?this.g():(this.m(this.u(o)),requestAnimationFrame(n))};n()}}const S=(t,s)=>new E(t,s);function O(t,s,n,i,o){return new Promise(r=>{S(i,o).$(i=>t.setAttribute(s,n(i))).M(()=>{t.setAttribute(s,n(1)),r()}).v()})}const x=t=>s=>t,D=(t,s)=>n=>t+n*(s-t),R=t=>{const s=t.length,n=1/(s-1),i=Array.from({length:s-1}).map((t,s)=>s),o=i.map(s=>(t[s+1]-t[s])/n),r=i.map(s=>t[s]-o[s]*s*n);return t=>{const i=Math.min(Math.floor(t/n),s-2);return o[i]*t+r[i]}};function C(t,...s){return function(n){let i="";for(let o=0;o<s.length;o++)i+=t[o]+s[o](n);return i+t[t.length-1]}}function Q(t,s=0,n=1,i=200,o=A.o){return O(t,"opacity",D(s,n),i,o)}function b(t,s=0,n=1,i=200,o=A.o){return O(t,"transform",C`scale(${D(s,n)})`,i,o)}function P(t,s,n,i,o,r){const e=n=>{const i=[];if(null!=o.k||null!=o.A){const s=null!=o.k?o.k(n):0,r=null!=o.A?o.A(n):0,e=t();e.setTranslate(s,r),i.push(e)}if(null!=o.scale){const s=o.scale(n),r=t();r.setScale(s,s),i.push(r)}if(null!=o.rotate){const s=o.rotate(n),r=t();r.setRotate(s,0,0),i.push(r)}s.transform.baseVal.clear(),i.forEach(t=>{s.transform.baseVal.appendItem(t)})};return new Promise(t=>{S(n,i).$(e).M(()=>{e(1),null!=r&&r(),t()}).v()})}const B=[1,2,3,4,5,6];function G(t,s,n){const i=[],o=2*Math.PI/s;for(let r=0;r<s;r++){const s=o*r+n,e=Math.cos(s),h=Math.sin(s),c=(e*t).toFixed(2),a=(h*t).toFixed(2);i.push([c,a])}return i.map(([t,s])=>`${t},${s}`).join(" ")}function H(t,n){return s("g",t,[s("polygon",n)])}const I=((...t)=>s=>{let n=0,i=1;for(let o=0;o<t.length;o++)n+=i*t[o],i*=s;return n})(0,12.995,-33.8325,33.18,-17.19,5.8475);Math.PI;const N=new class{constructor(t,s){this.size=t,this.T=s,this.S=[],this.O={1:"#e41a1c",2:"#377eb8",3:"#eaea28",4:"#4daf4a",5:"#984ea3",6:"#ff7f00"},this.D=[],this.R=[],this.C=[],this.P=[],this.B=new Map([[this.R,null],[this.D,null]]),this.G=((t,s)=>n=>{if(!(n.target instanceof Element))return this.H(t,s);const i=function(t,s){return function(t,s){let n=s;for(;;){if(null==n)return null;if(t(n))return n;n=n.parentElement}}(s=>s.matches(t),s)}("g.hit",n.target);if(null==i)return this.H(t,s);const o=i.dataset.index;if(null==o)return this.H(t,s);const r=+o;this.I(r,t,s)}),this.coords=M(this.size)}N(t){this.D.push(t)}F(t){this.R.push(t)}async L(){const{j:e,width:c,height:a,q:u}=this.T,l=this.coords.length,f=["transform",`translate(${c/2} ${a/2})`],w=new Array(l),d=new Array(l),y=new Array(l);this.U=["points",G(u,6,0)];const g=Math.sqrt(3),m=g/2,p=3*u/2,M=new t,$=new t,v=new t,k=new t;for(let t=0;t<this.coords.length;t++){const s=this.coords[t],[n,i]=s,e=p*i,h=u*(g*n+m*i);this.S[t]={x:e,y:h};const c=`translate(${e} ${h})`,a=H([["transform",`${c} scale(0.91)`],["opacity","0"]],[this.U,["fill","hsla(0, 0%, 0%, .02)"],["stroke","hsla(0, 0%, 0%, .08)"],["stroke-width","2"]]),l=H([["transform",`${c} rotate(30) scale(0.133)`]],[this.U,["opacity","0"]]),f=H([["transform",c],["opacity","0"]],[this.U]);r(f,[["index",t]]),o(f,"hit"),w[t]=a,d[t]=l,y[t]=f,M.set(n,i,a),v.set(n,i,l),k.set(n,i,f)}const T=s("g",[f],w),E=s("g",[f]),O=s("g",[f],d),x=s("g",[f]),D=s("g",[f],y);o(T,"plateau"),o(E,"tiles");const R=s("svg",[["width",c],["height",a]],[T,E,O,x,D]),C=function(t,s,o){const r=document.createElement(t);return null!=s&&n(r,s),null!=o&&i(r,...o),r}("div");i(C,R),i(e,C),this.X={Y:R,J:x,K:{V:C},W:{group:T,Z:M},_:{group:D,Z:k},tt:{group:O,Z:v},st:{group:E,Z:$}},this.nt();const Q=this,b=t=>s=>n(t,[["opacity",s]]),P=t=>()=>n(t,[["opacity","1"]]);S(100,A.o).$(b(w[0])).M(P(w[0])).v(),await h(60);for(let t=0;t<Q.size;t++){const s=3*t*(t+1)+1,n=6*(t+1);for(let t=0;t<n;t++){const n=s+t;S(100,A.o).$(b(w[n])).M(P(w[n])).v()}await h(60)}}async it(t,s){const{x:n,y:o}=this.S[t],[r,e]=this.coords[t],h=H([["transform",`translate(${n} ${o}) scale(0.921)`]],[["opacity","0"],this.U,["fill",this.O[s]]]);i(this.X.st.group,h),this.X.st.Z.set(r,e,h);const c=h.firstElementChild;Q(c,0,1,200,A.o),await b(c,.5,1,360,I)}async ot(t){const[s,n]=t,i=this.X.st.Z.delete(s,n);if(null==i)throw new Error(`No tile to destroy at (${s}, ${n}).`);const o=i.firstElementChild;Q(o,1,0,120,A.o),await b(o,1,1.5,200,A.o),o.remove()}async rt(t){const[s,n]=this.coords[t];P(()=>this.X.Y.createSVGTransform(),this.X.st.Z.t(s,n).firstElementChild,200,A.o,{scale:D(1,1.125),rotate:D(0,60)})}async et(t){const s=this.coords[t],[n,i]=s,o=this.X.st.Z.t(n,i).firstElementChild;P(()=>this.X.Y.createSVGTransform(),o,200,A.o,{scale:D(1.125,1)},()=>{o.transform.baseVal.clear()})}async ht(t,o){const r=new Array(t.length);for(let n=1;n<t.length;n++){const i=n-1,o=t[i],e=t[n],h=this.S[o],c=this.S[e],a=s("line",[["x1",h.x],["y1",h.y],["x2",c.x],["y2",c.y]]);r[i]=a}const e=this.X.J;e.innerHTML="",i(e,...r),n(e,[["stroke",this.O[o]],["stroke-width","12"],["stroke-linecap","round"]])}async ct(){const t=this.X.J;t.innerHTML="",n(t,[["opacity","1"]])}async move(t,s,n){const i=this.coords[t],o=this.coords[s],r=this.X.st.Z.t(...i);this.X.st.Z.delete(...i),this.X.st.Z.set(o[0],o[1],r);const e=n.map(t=>this.S[t].x),h=n.map(t=>this.S[t].y);await P(()=>this.X.Y.createSVGTransform(),r,40*n.length,A.h,{k:R(e),A:R(h),scale:x(.921)})}async at(t,s){this.C.push(t);const i=this.coords[t],[o,r]=i,e=this.X.tt.Z.t(o,r).firstElementChild;n(e,[["fill",this.O[s]]]),Q(e,0,.66,120,A.o),await b(e,.5,1,240,A.o)}async ut(){this.C.forEach(t=>this.lt(t)),this.C=[]}async lt(t){const s=this.coords[t],[n,i]=s,o=this.X.tt.Z.t(n,i).firstElementChild;await Q(o,.66,0,120,A.o)}async ft(t){this.P.push(t);const s=this.coords[t],[n,i]=s,o=this.X.W.Z.t(n,i).firstElementChild;await b(o,1,.33,120)}async wt(){this.P.forEach(t=>this.dt(t)),this.P=[]}async dt(t){const s=this.coords[t],[n,i]=s,o=this.X.W.Z.t(n,i).firstElementChild;await b(o,.33,1,300,A.h),function(t,s){for(const n of s)t.removeAttribute(n)}(o,["scale"])}H(t,s){const n=this.B.get(t);(s||-1!=n)&&(t.forEach(t=>t(-1,null)),this.B.set(t,-1))}I(t,s,n){const i=this.B.get(s);if(!n&&i==t)return;const o=this.coords[t];s.forEach(s=>s(t,o)),this.B.set(s,t)}nt(){document.addEventListener("click",this.G(this.R,!0)),document.addEventListener("mousemove",this.G(this.D,!1))}}(5,{j:document.getElementById("root"),q:45,width:1e3,height:1e3}),F=new class{constructor(s){this.yt=s,this.map=new t,this.gt=new t,this.pt=3,this.Mt=[],this.sourceIndex=-1,this.$t=-1;const n=M(this.size);for(let t=0;t<n.length;t++){const s=n[t],[i,o]=s;this.map.set(i,o,0),this.gt.set(i,o,t)}}get size(){return this.yt.size}async init(){await N.L(),this.vt();const t=this.kt();this.vt(),await this.At(t),this.Tt(),this.Et()}Tt(){this.yt.F((t,s)=>{this.St()?null==s||t==this.sourceIndex?this.Ot():this.xt(s)?this.move():(this.Ot(),this.Dt(t)):null==s||this.xt(s)||this.Dt(t)})}Et(){this.yt.N((t,s)=>{if(this.St())if(null!=s&&this.xt(s)){const n=g(this.Rt(this.sourceIndex),s,t=>this.xt(t),this.size);if(null==n)this.Ct();else{const s=n.map(t=>this.Qt(t));this.bt(t,s)}}else this.Ct()})}async Dt(t){this.sourceIndex=t;const s=this.Rt(t),n=this.Pt(s),i=function(t,s,n){const i=[t],o=[t];for(;o.length>0;){const t=o.pop(),r=y(n)(t).filter(t=>!f(i,t)).filter(s);o.push(...r),i.push(...r)}return i}(s,t=>this.xt(t),this.size),o=M(this.size).filter(t=>i.every(s=>!l(s,t))).filter(t=>this.xt(t)),r=p(this.size,s).map(t=>t.filter(t=>i.some(s=>l(t,s)))),e=p(this.size,s).map(t=>t.filter(t=>o.some(s=>l(t,s))));this.yt.rt(t);for(let t=0;t<r.length;t++)r[t].forEach(t=>{const s=this.Qt(t);this.yt.at(s,n)}),e[t].forEach(t=>{const s=this.Qt(t);this.yt.ft(s)}),await h(10)}async Ot(){const t=this.sourceIndex;this.sourceIndex=-1,await Promise.all([this.yt.et(t),this.yt.wt(),this.yt.ut()])}async bt(t,s){const n=this.sourceIndex;this.$t,this.$t=t;const i=this.Rt(n),o=this.Pt(i);await this.yt.ht(s,o)}async Ct(){this.$t=-1,await this.yt.ct()}async move(){const t=this.sourceIndex,s=this.$t,n=this.Rt(t),i=this.Pt(n),o=this.Rt(s),r=g(n,o,t=>this.xt(t),this.size);if(null==r)return this.Ot(),void this.Ct();this.map.set(n[0],n[1],0),this.map.set(o[0],o[1],i),this.Ot(),this.Ct(),await this.yt.move(t,s,r.map(t=>this.Qt(t)));const e=this.Bt();if(this.Gt(e),await this.Ht(e),0==e.It.length){const t=this.kt();await this.At(t);const s=this.Bt();this.Gt(s),await this.Ht(s),this.vt()}}Rt(t){const s=this.yt.coords[t];if(null==s)throw new Error(`Cannot get coord for ${t}.`);return s}Qt(t){const[s,n]=t;return this.gt.t(s,n)}Pt(t){const[s,n]=t;return this.map.t(s,n)}xt(t){return 0==this.Pt(t)}Nt(t,s){const[n,i]=t;this.map.set(n,i,s)}St(){return-1!=this.sourceIndex}Ft(){return-1!=this.$t}vt(){const t=this.pt;this.Mt=Array.from({length:t}).map(()=>e(B))}kt(){const t=[];for(const s of this.Mt){const n=e(this.map.keys().filter(t=>this.xt(t)));null==n&&this.Lt(),this.Nt(n,s);const i=this.Qt(n);t.push(i)}return t}async At(t){for(const s of t){const t=this.Rt(s),n=this.Pt(t);this.yt.it(s,n),await h(100)}}Bt(){const t={It:[],jt:[],qt:[],zt:[]},s=k(this.map.keys()),n=(t,s)=>{const n=this.Pt(t),i=this.Pt(s);return 0!=n&&n==i};for(const i of s)for(const s of i){const i=a(s,n,4);for(const[n,o]of i){const i=s.slice(n,o+1);t.jt.push(i);for(const s of i)t.It.every(t=>!l(t,s))&&t.It.push(s)}}const i=function(t){const s=new Set,n=[];for(let i=0;i<t.length;i++){const o=t[i];for(let r=0;r<o.length;r++){const e=o[r];if(s.has(e))continue;const h={Ut:e,S:[[i,r]]};for(let n=0;n<t.length;n++){const o=t[n];for(let t=0;t<o.length;t++){if(i==n&&r==t)continue;const c=o[t];s.has(c)||e==c&&h.S.push([n,t])}}h.S.length>1&&(s.add(e),n.push(h))}}return n}(t.jt);for(const s of i)2==s.S.length?t.qt.push(s.Ut):3==s.S.length&&t.zt.push(s.Ut);return t}Gt(t){for(const s of t.It){const[t,n]=s;this.map.set(t,n,0)}}async Ht(t){for(const s of t.It)this.yt.ot(s),await h(30)}Lt(){throw new Error("Game Over")}}(N);var L;L=(()=>F.init()),"complete"==document.readyState?L():window.addEventListener("load",L)}();
